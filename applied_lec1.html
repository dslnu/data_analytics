<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.24">

  <meta name="author" content="MSDE">
  <title>Big Data analytics / Applied Data analytics – Intro to Docker</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link rel="stylesheet" href="./custom.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/docker_ship.jpg" data-background-opacity="0.5" data-background-size="contain" class="quarto-title-block center">
  <h1 class="title">Intro to Docker</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
MSDE 
</div>
        <p class="quarto-title-affiliation">
            Lviv University
          </p>
    </div>
</div>

</section>
<section>
<section id="docker-overview" class="title-slide slide level1 center">
<h1>Docker overview</h1>

</section>
<section id="why-now" class="slide level2">
<h2>Why now?</h2>
<div class="columns">
<div class="column" data-background-color="lightgray" style="width:50%;">
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Before</strong></p>
</div>
<div class="callout-content">
<ul>
<li>monolithic applications</li>
<li>long development cycles</li>
<li>single environment</li>
<li>slowly scaling up</li>
</ul>
</div>
</div>
</div>
</div><div class="column" data-background-color="lightgray" style="width:50%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Now:</strong></p>
</div>
<div class="callout-content">
<ul>
<li>decoupled services</li>
<li>fast, iterative improvements</li>
<li>multiple environments</li>
<li>quickly scaling out</li>
</ul>
</div>
</div>
</div>
</div></div>
</section>
<section id="vms" class="slide level2">
<h2>VMs</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Description</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Virtual machines emulate physical computers by running operating systems in isolated instances.</li>
<li>Multiple VMs are commonly hosted on a single server, with a <strong>hypervisor</strong> acting as a lightweight software layer positioned between the physical host and the VMs.</li>
<li>This hypervisor efficiently manages access to resources, enabling virtual machines to function as distinct servers while offering enhanced flexibility and agility.</li>
<li>Gained popularity in the 2000s due to consolidation and cost saving initiatives</li>
</ul>
</div>
</div>
</div>
</section>
<section id="containers" class="slide level2">
<h2>Containers</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Description</strong></p>
</div>
<div class="callout-content">
<ul>
<li>A container is an isolated, lightweight silo for running an application on the host operating system.</li>
<li>Containers build on top of the host operating system’s kernel</li>
<li>Containers contain only apps and some lightweight operating system APIs and services</li>
</ul>
</div>
</div>
</div>
</section>
<section id="vms-vs-containers" class="slide level2">
<h2>VMs vs Containers</h2>
<p><img data-src="img/docker_vms_containers.png"> <!-- https://www.redhat.com/en/topics/containers/containers-vs-vms --></p>
</section>
<section id="deployment" class="slide level2">
<h2>Deployment</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Complexity</strong></p>
</div>
<div class="callout-content">
<p>Many different stacks:</p>
<ul>
<li>languages</li>
<li>frameworks</li>
<li>databases</li>
</ul>
<p>Many different targets:</p>
<ul>
<li>individual development environments</li>
<li>pre-production, QA, staging…</li>
<li>production: on prem, cloud, hybrid</li>
</ul>
</div>
</div>
</div>
</section>
<section id="deployment-1" class="slide level2">
<h2>Deployment</h2>

<img data-src="img/docker_deployment_problem.png" class="r-stretch"></section>
<section id="deployment-2" class="slide level2">
<h2>Deployment</h2>

<img data-src="img/docker_matrix.png" class="r-stretch"></section>
<section id="deployment-3" class="slide level2">
<h2>Deployment</h2>

<img data-src="img/docker_shipping_industry.png" class="r-stretch"></section>
<section id="deployment-4" class="slide level2">
<h2>Deployment</h2>

<img data-src="img/docker_shipping_industry2.png" class="r-stretch"></section>
<section id="deployment-5" class="slide level2">
<h2>Deployment</h2>

<img data-src="img/docker_shipping_industry3.png" class="r-stretch"></section>
<section id="deployment-6" class="slide level2">
<h2>Deployment</h2>

<img data-src="img/docker_shipping_industry4.png" class="r-stretch"></section>
<section id="deployment-7" class="slide level2">
<h2>Deployment</h2>

<img data-src="img/docker_breakbulk.png" class="r-stretch"></section>
<section id="deployment-8" class="slide level2">
<h2>Deployment</h2>

<img data-src="img/docker_matrix2.png" class="r-stretch"></section>
<section id="docker" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Results</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Dev-to-prod reduced from 9 months to 15 minutes (ING)</li>
<li>Continuous integration job time reduced by more than 60% (BBC)</li>
<li>Deploy 100 times a day instead of once a week (GILT)</li>
<li>70% infrastructure consolidation (MetLife)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-1" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>How to deploy now?</strong></p>
</div>
<div class="callout-content">
<p><strong>Escape dependency hell:</strong></p>
<ul>
<li>Write installation instructions into an <code>INSTALL.txt</code> file</li>
<li>Using this file, write an <code>install.sh</code> script that works for you</li>
<li>Turn this file into a <code>Dockerfile</code>, test it on your machine</li>
<li>If the Dockerfile builds on your machine, it will build anywhere</li>
<li>Rejoice as you escape dependency hell and “works on my machine”</li>
<li>Never again “worked in dev - ops problem now!”</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-2" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>How to deploy now?</strong></p>
</div>
<div class="callout-content">
<p>Quick onboarding</p>
<ul>
<li>Write Dockerfiles for your application components</li>
<li>Use pre-made images from the Docker Hub (mysql, redis…)</li>
<li>Describe your stack with a Compose file</li>
<li>On-board somebody with two commands:</li>
</ul>
<pre><code>git clone ...
docker-compose up</code></pre>
</div>
</div>
</div>
</section>
<section id="docker-3" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Implement reliable CI easily</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Build test environment with a Dockerfile or Compose file</li>
<li>For each test run, stage up a new container or stack</li>
<li>Each run is now in a clean environment</li>
<li>No pollution from previous tests</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-4" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Use container images as build artefacts</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Build your app from Dockerfiles</li>
<li>Store the resulting images in a registry</li>
<li>Keep them forever (or as long as necessary)</li>
<li>Test those images in QA, CI, integration…</li>
<li>Run the same images in production</li>
<li>Something goes wrong? Rollback to previous image</li>
<li>Investigating old regression? Old image has your back!</li>
<li>Images contain all the libraries, dependencies, etc. needed to run the app.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-formats" class="slide level2">
<h2>Docker: Formats</h2>
<div class="columns">
<div class="column" data-background-color="lightgray" style="width:50%;">
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Before</strong></p>
</div>
<div class="callout-content">
<ul>
<li>No standardized exchange format. <!-- (No, a rootfs tarball is not a format!) --></li>
<li>Containers are hard to use for developers. <!-- (Where's the equivalent of docker run debian?) --></li>
<li>As a result, they are hidden from the end users.</li>
<li>No re-usable components, APIs, tools. <!-- (At best: VM abstractions, e.g. libvirt.) --></li>
</ul>
<!-- Analogy: -->
<!-- Shipping containers are not just steel boxes. -->
<!-- They are steel boxes that are a standard size, with the same hooks and holes. -->
</div>
</div>
</div>
</div><div class="column" data-background-color="lightgray" style="width:50%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>After</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Standardize the container format, because containers were not portable.</li>
<li>Make containers easy to use for developers.</li>
<li>Emphasis on re-usable components, APIs, ecosystem of standard tools.</li>
<li>Improvement over ad-hoc, in-house, specific tools.</li>
</ul>
</div>
</div>
</div>
</div></div>
</section>
<section id="docker-deployment" class="slide level2">
<h2>Docker: Deployment</h2>
<div class="columns">
<div class="column" data-background-color="lightgray" style="width:50%;">
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Before</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Ship packages: deb, rpm, gem, jar, homebrew…</li>
<li>Dependency hell.</li>
<li>“Works on my machine.”</li>
<li>Base deployment often done from scratch and unreliable.</li>
</ul>
</div>
</div>
</div>
</div><div class="column" data-background-color="lightgray" style="width:50%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>After</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Ship container images with all their dependencies.</li>
<li>Images are bigger, but they are broken down into layers.</li>
<li>Only ship layers that have changed.</li>
<li>Save disk, network, memory usage.</li>
</ul>
</div>
</div>
</div>
</div></div>
</section>
<section id="docker-5" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>Layers:</p>
<ul>
<li>CentOS</li>
<li>JRE</li>
<li>Tomcat</li>
<li>Dependencies</li>
<li>Application JAR</li>
<li>Configuration</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-devops" class="slide level2">
<h2>Docker: Devops</h2>
<div class="columns">
<div class="column" data-background-color="lightgray" style="width:50%;">
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Before</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Drop a tarball (or a commit hash) with instructions.</li>
<li>Dev environment very different from production.</li>
<li>Ops don’t always have a dev environment themselves …</li>
<li>… and when they do, it can differ from the devs’.</li>
<li>Ops have to sort out differences and make it work …</li>
<li>… or bounce it back to devs.</li>
<li>Shipping code causes frictions and delays.</li>
</ul>
</div>
</div>
</div>
</div><div class="column" data-background-color="lightgray" style="width:50%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>After</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Drop a container image or a Compose file.</li>
<li>Ops can always run that container image.</li>
<li>Ops can always run that Compose file.</li>
<li>Ops still have to adapt to prod environment, but at least they have a reference point.</li>
<li>Ops have tools allowing to use the same image in dev and prod.</li>
<li>Devs can be empowered to make releases themselves more easily.</li>
</ul>
</div>
</div>
</div>
</div></div>
</section>
<section id="docker-history" class="slide level2">
<h2>Docker history</h2>

<img data-src="img/docker_vps_age.png" class="r-stretch"></section>
<section id="docker-history-1" class="slide level2">
<h2>Docker history</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>dotCloud</strong></p>
</div>
<div class="callout-content">
<ul>
<li>dotCloud was operating a PaaS, using a custom container engine.</li>
<li>This engine was based on OpenVZ (and later, LXC) and AUFS.</li>
<li>It started (circa 2008) as a single Python script.</li>
<li>By 2012, the engine had multiple (~10) Python components. (and ~100 other micro-services!)</li>
<li>End of 2012, dotCloud refactors this container engine.</li>
<li>The codename for this project is “Docker.”</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-history-2" class="slide level2">
<h2>Docker history</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>First public release</strong></p>
</div>
<div class="callout-content">
<ul>
<li>March 2013, PyCon, Santa Clara:
<ul>
<li>“Docker” is shown to a public audience for the first time.</li>
</ul></li>
<li>It is released with an open source license.</li>
<li>Very positive reactions and feedback!</li>
<li>The dotCloud team progressively shifts to Docker development.</li>
<li>The same year, dotCloud changes name to Docker. <!-- In 2014, the PaaS activity is sold. --></li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-history-3" class="slide level2">
<h2>Docker history</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>After release</strong></p>
</div>
<div class="callout-content">
<ul>
<li>2013: fixing bugs around OS support</li>
<li>2014: Docker Compose v1 (written in Python)</li>
<li>2015: version 1.0, Open Containers Initiative</li>
<li>2015: creation of the Cloud Native Computing Foundation</li>
<li>2020: Docker Compose v2 (re-written in Go)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="containerd" class="slide level2">
<h2>containerd</h2>

<img data-src="img/docker_containerd_architecture.png" class="r-stretch"></section></section>
<section>
<section id="installation" class="title-slide slide level1 center">
<h1>Installation</h1>

</section>
<section id="docker-installation" class="slide level2">
<h2>Docker installation</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>What is Docker?</strong></p>
</div>
<div class="callout-content">
<ul>
<li>“Installing Docker” really means “Installing the Docker Engine and CLI”.</li>
<li>The Docker Engine is a daemon (a service running in the background).</li>
<li>This daemon manages containers, the same way that a hypervisor manages VMs.</li>
<li>We interact with the Docker Engine by using the Docker CLI.</li>
<li>The Docker CLI and the Docker Engine communicate through an API.</li>
<li>There are many other programs and client libraries which use that API.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-installation-1" class="slide level2">
<h2>Docker installation</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Docker Desktop</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Leverages the host OS virtualization subsystem</li>
<li>Under the hood, runs a tiny VM</li>
<li>Accesses network resources like normal applications</li>
<li>Supports filesystem sharing through volumes</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-installation-2" class="slide level2">
<h2>Docker installation</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Docker Desktop</strong></p>
</div>
<div class="callout-content">
<p>When you execute docker version from the terminal:</p>
<ul>
<li>the CLI connects to the Docker Engine over a standard socket,</li>
<li>the Docker Engine is, in fact, running in a VM,</li>
<li>… but the CLI doesn’t know or care about that,</li>
<li>the CLI sends a request using the REST API,</li>
<li>the Docker Engine in the VM processes the request,</li>
<li>the CLI gets the response and displays it to you.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-installation-3" class="slide level2">
<h2>Docker installation</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Check that it works</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker version

Client:
 Version:           28.2.2
 API version:       1.50
 Go version:        go1.24.3
 Git commit:        e6534b4
 Built:             Fri May 30 12:07:35 2025
 OS/Arch:           darwin/arm64
 Context:           desktop-linux

Server: Docker Desktop 4.42.1 (196648)
 Engine:
  Version:          28.2.2
  API version:      1.50 (minimum version 1.24)
  Go version:       go1.24.3
  Git commit:       45873be
  Built:            Fri May 30 12:07:27 2025
  OS/Arch:          linux/arm64
  Experimental:     false
 containerd:
  Version:          1.7.27
  GitCommit:        05044ec0a9a75232cad458027ca83437aae3f4da
 runc:
  Version:          1.2.5
  GitCommit:        v1.2.5-0-g59923ef
 docker-init:
  Version:          0.19.0
  GitCommit:        de40ad0
</code></pre>
</div>
</div>
</div>
</section>
<section id="docker-installation-busybox" class="slide level2">
<h2>Docker installation: Busybox</h2>

<img data-src="img/docker_busybox.png" class="r-stretch"><div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>What is it?</strong></p>
</div>
<div class="callout-content">
<ul>
<li>provides several Unix utilities in a single executable file.</li>
<li>very space-efficient</li>
<li>created for embedded operating systems with very limited resources.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Check that it works</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker run busybox echo hello world
Unable to find image 'busybox:latest' locally
latest: Pulling from library/busybox
499bcf3c8ead: Pull complete
Digest: sha256:d82f458899c9696cb26a7c02d5568f81c8c8223f8661bb2a7988b269c8b9051e
Status: Downloaded newer image for busybox:latest
hello world</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="interactive-containers" class="title-slide slide level1 center">
<h1>Interactive containers</h1>

</section>
<section id="docker-installation-ubuntu" class="slide level2">
<h2>Docker installation: Ubuntu</h2>
<p><img data-src="img/docker_ubuntu.png" height="100"></p>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Running Ubuntu</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker run -it ubuntu
Unable to find image 'ubuntu:latest' locally
latest: Pulling from library/ubuntu
59a5d47f84c3: Pull complete
Digest: sha256:353675e2a41babd526e2b837d7ec780c2a05bca0164f7ea5dbbd433d21d166fc
Status: Downloaded newer image for ubuntu:latest
root@014ed1f2eac1:/# sudo apt-get moo
bash: sudo: command not found
root@014ed1f2eac1:/# apt-get moo
                 (__)
                 (oo)
           /------\/
          / |    ||
         *  /\---/\
            ~~   ~~
..."Have you mooed today?"...
root@014ed1f2eac1:/#</code></pre>
</div>
</div>
</div>
</section>
<section id="docker-installation-ubuntu-1" class="slide level2">
<h2>Docker installation: Ubuntu</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>What does this mean?</strong></p>
</div>
<div class="callout-content">
<ul>
<li>It runs a bare-bones, no-frills ubuntu system.</li>
<li><code>-it</code> is shorthand for -i -t.</li>
<li><code>-i</code> tells Docker to connect us to the container’s <code>stdin.</code>: e.g.&nbsp;<strong>interactive</strong> mode.</li>
<li><code>-t</code> tells Docker that we want a pseudo-terminal.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-installation-ubuntu-2" class="slide level2">
<h2>Docker installation: Ubuntu</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Run something</strong></p>
</div>
<div class="callout-content">
<pre><code>root@014ed1f2eac1:/# figlet hello
bash: figlet: command not found

root@014ed1f2eac1:/# apt-get update &amp;&amp; apt-get install figlet
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  figlet
...
Unpacking figlet (2.2.5-3) ...
root@014ed1f2eac1:/# figlet hello
 _          _ _
| |__   ___| | | ___
| '_ \ / _ \ | |/ _ \
| | | |  __/ | | (_) |
|_| |_|\___|_|_|\___/

root@014ed1f2eac1:/#</code></pre>
</div>
</div>
</div>
</section>
<section id="docker-installation-ubuntu-3" class="slide level2">
<h2>Docker installation: Ubuntu</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Exit the container via <code>exit</code> or <code>Ctrl-D</code>.</p>
<p>If we try running <code>figlet</code> again, this won’t work - it’s only installed <strong>inside</strong> the container.</p>
</div>
</div>
</div>
</section>
<section id="docker-installation-ubuntu-4" class="slide level2">
<h2>Docker installation: Ubuntu</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Hosts vs Containers</strong></p>
</div>
<div class="callout-content">
<ul>
<li>We ran an ubuntu container on an Linux/Windows/macOS host.</li>
<li>They have different, independent packages.</li>
<li>Installing something on the host doesn’t expose it to the container.</li>
<li>And vice-versa.</li>
<li>Even if both the host and the container have the same Linux distro!</li>
<li>We can run any container on any host.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-6" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Where’s our container now</strong></p>
</div>
<div class="callout-content">
<ul>
<li>in a <strong>stopped</strong> state</li>
<li>using <strong>disk storage</strong></li>
<li>NOT using <strong>CPU</strong> or <strong>memory</strong></li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-7" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Start a new container</strong></p>
</div>
<div class="callout-content">
<pre><code>docker run -it ubuntu
root@5c6dc90eb867:/# figlet
bash: figlet: command not found
root@5c6dc90eb867:/#</code></pre>
<p>Why?</p>
<ul>
<li>We started a brand new container.</li>
<li>The basic Ubuntu <strong>image</strong> was used, and figlet is not here.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-8" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Can we restore our container somehow?</strong></p>
</div>
<div class="callout-content">
<p>We can, but that’s not the <strong>default workflow</strong> with Docker.</p>
</div>
</div>
</div>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>What’s the default workflow, then?</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Always start with a fresh container.</li>
<li>If we need something installed in our container, build a custom image.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Why so complicated?</strong></p>
</div>
<div class="callout-content">
<ul>
<li>It’s quite easy actually</li>
<li>This puts a strong emphasis on automation and repeatability. Let’s see why …</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-9" class="slide level2">
<h2>Docker</h2>

<img data-src="img/docker_pets_cattle.png" class="r-stretch"></section>
<section id="docker-10" class="slide level2">
<h2>Docker</h2>
<div class="columns">
<div class="column" data-background-color="lightgray" style="width:50%;">
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Pets</strong></p>
</div>
<div class="callout-content">
<ul>
<li>have distinctive names and unique configurations</li>
<li>when they have an outage, we do everything we can to fix them</li>
</ul>
</div>
</div>
</div>
</div><div class="column" data-background-color="lightgray" style="width:50%;">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Cattle</strong></p>
</div>
<div class="callout-content">
<ul>
<li>have generic names (e.g.&nbsp;with numbers) and generic configuration</li>
<li>configuration is enforced by configuration management, golden images …</li>
<li>when they have an outage, we can replace them immediately with a new server</li>
</ul>
</div>
</div>
</div>
</div></div>
</section>
<section id="docker-11" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Pet VM</strong></p>
</div>
<div class="callout-content">
<p>When we use local VMs (with e.g.&nbsp;VirtualBox or VMware), our workflow looks like this:</p>
<ul>
<li>create VM from base template (Ubuntu, CentOS…)</li>
<li>install packages, set up environment</li>
<li>work on project</li>
<li>when done, shut down VM</li>
<li>next time we need to work on project, restart VM as we left it</li>
<li>if we need to tweak the environment, we do it live</li>
<li>Over time, the VM configuration evolves, diverges.</li>
<li>We don’t have a clean, reliable, deterministic way to provision that environment.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-12" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Cattle container</strong></p>
</div>
<div class="callout-content">
<p>With Docker, the workflow looks like this:</p>
<ul>
<li>create container image with our dev environment</li>
<li>run container with that image</li>
<li>work on project</li>
<li>when done, shut down container</li>
<li>next time we need to work on project, start a new container</li>
<li>if we need to tweak the environment, we create a new image</li>
<li>We have a clear definition of our environment, and can share it reliably with others.</li>
</ul>
</div>
</div>
</div>
</section></section>
<section>
<section id="background-containers" class="title-slide slide level1 center">
<h1>Background containers</h1>

</section>
<section id="docker-13" class="slide level2">
<h2>Docker</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Non-interactive containers</strong></p>
</div>
<div class="callout-content">
<p>Our first containers were interactive.</p>
<p>We will now see how to:</p>
<ul>
<li>Run a non-interactive container.</li>
<li>Run a container in the background.</li>
<li>List running containers.</li>
<li>Check the logs of a container.</li>
<li>Stop a container.</li>
<li>List stopped containers.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-1" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>We will run a small custom container. This container just displays the time every second.</p>
<pre><code>$ docker run jpetazzo/clock
Unable to find image 'jpetazzo/clock:latest' locally
latest: Pulling from jpetazzo/clock
36fbfd22ebfc: Pull complete
Digest: sha256:dc06bbc3744f7200404bff0bbb2516925e7adea115e07de9da8b36bf15fe3dd3
Status: Downloaded newer image for jpetazzo/clock:latest
Sat Sep 20 11:00:45 UTC 2025
Sat Sep 20 11:00:46 UTC 2025
Sat Sep 20 11:00:47 UTC 2025
^C%</code></pre>
<ul>
<li>This container will run forever.</li>
<li>To stop it, press ^C.</li>
<li>Docker has automatically downloaded the image jpetazzo/clock.</li>
<li>This image is a user image, created by <code>jpetazzo.</code> <!-- - We will hear more about user images (and other types of images) later. --></li>
</ul>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-2" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Ctrl-C might now always work!</strong></p>
</div>
<div class="callout-content">
<p>What happens when we hit <code>Ctrl-C</code>:</p>
<ul>
<li>SIGINT gets sent to the container, which means:</li>
<li>SIGINT gets sent to PID 1 (default case)</li>
<li>SIGINT gets sent to foreground processes when running with -ti</li>
</ul>
<p>But there is a special case for PID 1: it ignores all signals!</p>
<ul>
<li>except SIGKILL and SIGSTOP</li>
<li>except signals handled explicitly</li>
</ul>
<p><strong>TL,DR:</strong> there are many circumstances when <code>Ctrl-C</code> won’t stop the container.</p>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-3" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Why is PID 1 special?</strong></p>
</div>
<div class="callout-content">
<p>PID 1 has some extra responsibilities:</p>
<ul>
<li>it starts (directly or indirectly) every other process</li>
<li>when a process exits, its processes are “reparented” under PID 1</li>
<li>When PID 1 exits, everything stops:</li>
<li>on a “regular” machine, it causes a kernel panic</li>
<li>in a container, it kills all the processes</li>
</ul>
<p><strong>Ergo:</strong> We don’t want PID 1 to stop accidentally. That’s why it has these extra protections.</p>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-4" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Solution</strong></p>
</div>
<div class="callout-content">
<p><img data-src="img/docker_kill.jpg" height="500"></p>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-5" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Daemon mode</strong></p>
</div>
<div class="callout-content">
<p>Containers can be started in the background, with the -d flag (daemon mode):</p>
<pre><code>$ docker run -d jpetazzo/clock
896ffc453901fc7d7c417381c8bde9a8911182d07b819dc988aa0b4d1c298d3e</code></pre>
<ul>
<li>We don’t see the output of the container.</li>
<li>But don’t worry: Docker collects that output and logs it!</li>
<li>Docker gives us the ID of the container.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-6" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Maxwell demon: MIT’s Project MAC</strong></p>
</div>
<div class="callout-content">
<p><img data-src="img/docker_maxwell_demon.png"></p>
</div>
</div>
</div>

<!-- https://stackoverflow.com/questions/33690277/why-are-daemons-called-daemons -->
<!-- https://english.stackexchange.com/questions/31430/what-is-the-origin-of-daemon-with-regards-to-computing -->
<aside><div>
<p>https://en.wikipedia.org/wiki/Maxwell’s_demon</p>
</div></aside></section>
<section id="non-interactive-containers-7" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>List running containers</strong></p>
</div>
<div class="callout-content">
<p>How can we check that our container is still running?</p>
<p>With <code>docker ps</code>, just like the UNIX ps command, lists running processes.</p>
<pre><code>$ docker ps
CONTAINER ID   IMAGE            COMMAND                  CREATED         STATUS                PORTS                                             NAMES
896ffc453901   jpetazzo/clock   "/bin/sh -c 'while d…"   5 minutes ago   Up 5 minutes                                                            quirky_wilson
</code></pre>
<p>Docker tells us:</p>
<ul>
<li>The (truncated) ID of our container.</li>
<li>The image used to start the container.</li>
<li>That our container has been running (Up) for a couple of minutes.</li>
<li>Other information (COMMAND, PORTS, NAMES) that we will explain later.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-8" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>More containers</strong></p>
</div>
<div class="callout-content">
<p>Run 2 more:</p>
<pre><code>$ docker run -d jpetazzo/clock

42518eae35544162179d3f7086410949256a767244e36e40518f0f9d1dd223ae
$ docker run -d jpetazzo/clock

31a2d9cc7e40d58280b9e5cdd6135cf824559bc1ab6409f026c3a0c82419273e</code></pre>
<p>Check running:</p>
<pre><code>$ docker ps
CONTAINER ID   IMAGE            COMMAND                  CREATED          STATUS                PORTS                                             NAMES
31a2d9cc7e40   jpetazzo/clock   "/bin/sh -c 'while d…"   30 seconds ago   Up 29 seconds                                                           optimistic_payne
42518eae3554   jpetazzo/clock   "/bin/sh -c 'while d…"   31 seconds ago   Up 30 seconds                                                           beautiful_kalam
896ffc453901   jpetazzo/clock   "/bin/sh -c 'while d…"   7 minutes ago    Up 7 minutes                                                            quirky_wilson</code></pre>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-9" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Last run container</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker ps -l
CONTAINER ID   IMAGE            COMMAND                  CREATED              STATUS              PORTS     NAMES
31a2d9cc7e40   jpetazzo/clock   "/bin/sh -c 'while d…"   About a minute ago   Up About a minute             optimistic_payne</code></pre>
</div>
</div>
</div>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>IDs only</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker ps -q
31a2d9cc7e40
42518eae3554
896ffc453901</code></pre>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-10" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Container logs</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker logs 31a
...
...
...
Sat Sep 20 11:18:46 UTC 2025
Sat Sep 20 11:18:47 UTC 2025
Sat Sep 20 11:18:48 UTC 2025
Sat Sep 20 11:18:49 UTC 2025
Sat Sep 20 11:18:50 UTC 2025
Sat Sep 20 11:18:51 UTC 2025
Sat Sep 20 11:18:52 UTC 2025
Sat Sep 20 11:18:53 UTC 2025
Sat Sep 20 11:18:54 UTC 2025
Sat Sep 20 11:18:55 UTC 2025
Sat Sep 20 11:18:56 UTC 2025
Sat Sep 20 11:18:57 UTC 2025
Sat Sep 20 11:18:58 UTC 2025
Sat Sep 20 11:18:59 UTC 2025
Sat Sep 20 11:19:00 UTC 2025
</code></pre>
<p><strong>All</strong> logs are dumped - a bit too much.</p>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-11" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Container logs tail</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker logs --tail 5 31a
Sat Sep 20 11:19:55 UTC 2025
Sat Sep 20 11:19:56 UTC 2025
Sat Sep 20 11:19:57 UTC 2025
Sat Sep 20 11:19:58 UTC 2025
Sat Sep 20 11:19:59 UTC 2025</code></pre>
</div>
</div>
</div>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Container logs tail &amp; follow</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker logs --tail 1 --follow 31a
Sat Sep 20 11:21:45 UTC 2025
Sat Sep 20 11:21:46 UTC 2025
Sat Sep 20 11:21:47 UTC 2025
Sat Sep 20 11:21:48 UTC 2025
Sat Sep 20 11:21:49 UTC 2025
</code></pre>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-12" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Stopping</strong></p>
</div>
<div class="callout-content">
<p>There are two ways we can terminate our detached container.</p>
<ul>
<li>Killing it using the <code>docker kill</code> command.
<ul>
<li>stops the container immediately, by using the KILL signal.</li>
</ul></li>
<li>Stopping it using the <code>docker stop</code> command.
<ul>
<li>sends a TERM signal, and after 10 seconds, if the container has not stopped, it sends KILL.</li>
</ul></li>
</ul>
<p><strong>Reminder:</strong> the KILL signal cannot be intercepted, and will forcibly terminate the container.</p>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-13" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Stopping: Example</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker stop 31a
&lt;10 seconds pass&gt;
31a</code></pre>
<ul>
<li>Docker sends the TERM signal;</li>
<li>the container doesn’t react to this signal (it’s a simple Shell script with no special signal handling);</li>
<li>10 seconds later, since the container is still running, Docker sends the KILL signal;</li>
<li>this terminates the container.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-14" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Killing: Example</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker kill 425 896
425
896</code></pre>
<p>Those containers will be terminated immediately (without the 10-second delay).</p>
</div>
</div>
</div>
</section>
<section id="non-interactive-containers-15" class="slide level2">
<h2>Non-interactive containers</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>List stopped containers</strong></p>
</div>
<div class="callout-content">
<p>We can also see stopped containers, with the -a (–all) option.</p>
<pre><code>$ docker ps -a
CONTAINER ID   IMAGE                                          COMMAND                  CREATED             STATUS                            PORTS     NAMES
31a2d9cc7e40   jpetazzo/clock                                 "/bin/sh -c 'while d…"   12 minutes ago      Exited (137) 2 minutes ago                  optimistic_payne
42518eae3554   jpetazzo/clock                                 "/bin/sh -c 'while d…"   12 minutes ago      Exited (137) About a minute ago             beautiful_kalam
896ffc453901   jpetazzo/clock                                 "/bin/sh -c 'while d…"   19 minutes ago      Exited (137) About a minute ago             quirky_wilson
74b84530ad71   jpetazzo/clock                                 "/bin/sh -c 'while d…"   26 minutes ago      Exited (130) 26 minutes ago                 amazing_cohen
5c6dc90eb867   ubuntu                                         "/bin/bash"              40 minutes ago      Exited (130) 26 minutes ago                 thirsty_bardeen
014ed1f2eac1   ubuntu                                         "/bin/bash"              52 minutes ago      Exited (0) 40 minutes ago                   elated_darwin
42f574fdf1af   busybox                                        "echo hello world"       About an hour ago   Exited (0) About an hour ago                suspicious_franklin
</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="restarting-and-attaching-to-containers" class="title-slide slide level1 center">
<h1>Restarting and attaching to containers</h1>

</section>
<section id="restarting-and-attaching" class="slide level2">
<h2>Restarting and attaching</h2>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Background vs foreground</strong></p>
</div>
<div class="callout-content">
<ul>
<li>The distinction between foreground and background containers is arbitrary.</li>
<li>From Docker’s point of view, all containers are the same.</li>
<li>All containers run the same way, whether there is a client attached to them or not.</li>
<li>It is always possible to detach from a container, and to reattach to a container.</li>
<li>Analogy: attaching to a container is like plugging a keyboard and screen to a physical server.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="restarting-and-attaching-1" class="slide level2">
<h2>Restarting and attaching</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Detaching from containers</strong></p>
</div>
<div class="callout-content">
<p>If you have started an interactive container (with option -it), you can detach from it.</p>
<p>The “detach” sequence is <code>Ctrl-P Ctrl-Q</code> or <code>Ctrl-C</code> on Windows.</p>
<p>Otherwise you can detach by killing the Docker client. <!-- (But not by hitting ^C, as this would deliver SIGINT to the container.) --></p>
</div>
</div>
</div>
</section>
<section id="restarting-and-attaching-2" class="slide level2">
<h2>Restarting and attaching</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Custom detach</strong></p>
</div>
<div class="callout-content">
<p>You can change the sequence with <code>docker run --detach-keys</code>.</p>
<p>This can also be passed as a global option to the engine.</p>
<p>Start a container with a custom detach command:</p>
<pre><code>$ docker run -ti --detach-keys ctrl-x,x jpetazzo/clock</code></pre>
<p>Detach by hitting <code>Ctrl-X x</code>.</p>
<pre><code>$ docker ps -l</code></pre>
</div>
</div>
</div>
</section>
<section id="restarting-and-attaching-3" class="slide level2">
<h2>Restarting and attaching</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Attaching</strong></p>
</div>
<div class="callout-content">
<p>You can attach to a container:</p>
<pre><code>$ docker attach &lt;containerID&gt;</code></pre>
<p>The container must be running.</p>
<p>There can be multiple clients attached to the same container.</p>
<p>If you don’t specify <code>--detach-keys</code> when attaching, it defaults back to <code>Ctrl-P Ctrl-Q</code>.</p>
<p>Try it on our previous container:</p>
<pre><code>$ docker attach $(docker ps -lq)</code></pre>
</div>
</div>
</div>
</section>
<section id="restarting-and-attaching-4" class="slide level2">
<h2>Restarting and attaching</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Detaching from non-interactive containers</strong></p>
</div>
<div class="callout-content">
<p>Warning: if the container was started without <code>-it...</code>, you won’t be able to detach with <code>Ctrl-P Ctrl-Q</code>. If you hit <code>Ctrl-C</code>, the signal will be proxied to the container.</p>
<p><strong>Remember:</strong> you can always detach by killing the Docker client.</p>
</div>
</div>
</div>
</section>
<section id="restarting-and-attaching-5" class="slide level2">
<h2>Restarting and attaching</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Restarting a container</strong></p>
</div>
<div class="callout-content">
<p>When a container has exited, it is in stopped state.</p>
<p>It can then be restarted with the start command.</p>
<pre><code>$ docker start &lt;yourContainerID&gt;</code></pre>
<p>The container will be restarted using the same options you launched it with.</p>
<p>You can re-attach to it if you want to interact with it:</p>
<pre><code>$ docker attach &lt;yourContainerID&gt;</code></pre>
<p>Use <code>docker ps -a</code> to identify the container ID of a previous <code>jpetazzo/clock</code> container, and try those commands.</p>
</div>
</div>
</div>
<!--
## Restarting and attaching
:::{.callout-tip icon=false}
## Attaching to a REPL
REPL = Read Eval Print Loop
Shells, interpreters, TUI ...
Symptom: you docker attach, and see nothing
The REPL doesn't know that you just attached, and doesn't print anything
Try hitting ^L or Enter
:::

:::{.callout-important icon=false}
## SIGWINCH

When you docker attach, the Docker Engine sends SIGWINCH signals to the container.

SIGWINCH = WINdow CHange; indicates a change in window size.

This will cause some CLI and TUI programs to redraw the screen.

But not all of them.
:::
-->
</section></section>
<section>
<section id="docker-images" class="title-slide slide level1 center">
<h1>Docker Images</h1>

</section>
<section id="docker-images-1" class="slide level2">
<h2>Docker Images</h2>

<img data-src="img/docker_understanding_images.png" class="r-stretch"><div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Outline</strong></p>
</div>
<div class="callout-content">
<p>What we will go through now:</p>
<ul>
<li>What is an image.</li>
<li>What is a layer.</li>
<li>The various image namespaces.</li>
<li>How to search and download images.</li>
<li>Image tags and when to use them.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-2" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>What is an image?</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Image = files + metadata</li>
<li>These files form the root filesystem of our container.</li>
<li>The metadata can indicate a number of things, e.g.:
<ul>
<li>the author of the image</li>
<li>the command to execute in the container when starting it</li>
<li>environment variables to be set</li>
<li>etc.</li>
</ul></li>
<li>Images are made of layers, conceptually stacked on top of each other.</li>
<li>Each layer can add, change, and remove files and/or metadata.</li>
<li>Images can share layers to optimize disk usage, transfer times, and memory use.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-3" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Docker Image Example: Website</strong></p>
</div>
<div class="callout-content">
<p>The images will contain these layers:</p>
<ul>
<li>CentOS base layer</li>
<li>Packages and configuration files added by our local IT</li>
<li>Python installation</li>
<li>Flask/Django</li>
<li>Our application’s dependencies</li>
<li>Our application code and assets</li>
<li>Our application configuration</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>App config is generally added by orchestration facilities.</p>
</div>
</div>
</div>
</section>
<section id="docker-images-4" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Read-write layer</strong></p>
</div>
<div class="callout-content">
<p>Exists on top of image layers.</p>
<p><img data-src="img/docker_rw_layer.jpg"></p>
</div>
</div>
</div>
</section>
<section id="docker-images-5" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Containers vs Images</strong></p>
</div>
<div class="callout-content">
<ul>
<li>an image is a <strong>read-only</strong> filesystem.</li>
<li>a container is an encapsulated set of processes,</li>
<li>running in a read-write copy of that filesystem.</li>
<li>to optimize container boot time, copy-on-write is used instead of regular copy.</li>
<li>docker run starts a container from a given image.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-6" class="slide level2">
<h2>Docker Images</h2>

<img data-src="img/docker_sharing_layers.jpg" class="r-stretch"></section>
<section id="docker-images-7" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Compared to Python objects/classes</strong></p>
</div>
<div class="callout-content">
<ul>
<li><strong>Images</strong> are conceptually similar to <strong>classes.</strong></li>
<li><strong>Layers</strong> are conceptually similar to <strong>inheritance.</strong></li>
<li><strong>Containers</strong> are conceptually similar to <strong>instances.</strong></li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-8" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>How do change read-only images?</strong></p>
</div>
<div class="callout-content">
<p>If an image is read-only, how do we change it?</p>
<ul>
<li>We don’t.</li>
<li>We create a new container from that image.</li>
<li>Then we make changes to that container.</li>
<li>When we are satisfied with those changes, we transform them into a new layer.</li>
<li>A new image is created by stacking the new layer on top of the old image.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-9" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>How do we create empty images?</strong></p>
</div>
<div class="callout-content">
<ol type="1">
<li><p>There is a special empty image called <code>scratch.</code> <br> It allows to build from scratch.</p></li>
<li><p>The <code>docker import</code> command loads a tarball into Docker. <br> The imported tarball becomes a standalone image. <br> That new image has a single layer.</p></li>
</ol>
<p><strong>Note:</strong> you will probably never have to do this yourself.</p>
</div>
</div>
</div>
</section>
<section id="docker-images-10" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>How do we create other images?</strong></p>
</div>
<div class="callout-content">
<p><code>docker commit</code></p>
<ul>
<li>Saves all the changes made to a container into a new layer.</li>
<li>Creates a new image (effectively a copy of the container).</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Another option</strong></p>
</div>
<div class="callout-content">
<p><code>docker build</code> (used 99% of the time)</p>
<ul>
<li>Performs a repeatable build sequence.</li>
<li>This is the preferred method!</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-11" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Image namespaces</strong></p>
</div>
<div class="callout-content">
<p>Images have names, and these names can belong to three <strong>namespaces</strong>:</p>
<ul>
<li>Official images (root namespace)</li>
</ul>
<p> e.g.&nbsp;<code>ubuntu</code>, <code>busybox</code> …</p>
<ul>
<li>User (and organizations) images (user namespace)</li>
</ul>
<p> e.g.&nbsp;<code>jpetazzo/clock</code></p>
<ul>
<li>Self-hosted images (self-hosted namespace)</li>
</ul>
<p> e.g.&nbsp;<code>registry.example.com:5000/my-private/image</code></p>
</div>
</div>
</div>
</section>
<section id="docker-images-12" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Root namespace</strong></p>
</div>
<div class="callout-content">
<ul>
<li>The root namespace is for official images.</li>
<li>They are gated by Docker Inc.</li>
<li>They are generally authored and maintained by third parties.</li>
<li>Those images include:</li>
<li>Small, “swiss-army-knife” images like <code>busybox.</code></li>
<li>Distro images to be used as bases for your builds, like <code>ubuntu</code>, <code>fedora...</code></li>
<li>Ready-to-use components and services, like <code>redis</code>, <code>postgresql...</code></li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-13" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>User namespace</strong></p>
</div>
<div class="callout-content">
<p>The user namespace holds images for Docker Hub users and organizations. For example:</p>
<p><code>jpetazzo/clock</code></p>
<p>The Docker Hub user is:</p>
<p><code>jpetazzo</code></p>
<p>The image name is:</p>
<p><code>clock</code></p>
</div>
</div>
</div>
</section>
<section id="docker-images-14" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Self-hosted namespace</strong></p>
</div>
<div class="callout-content">
<p>This namespace holds images which are not hosted on Docker Hub, but on third party registries.</p>
<p>They contain the hostname (or IP address), and optionally the port, of the registry server.</p>
<p>For example:</p>
<p><code>localhost:5000/wordpress</code></p>
<ul>
<li><code>localhost:5000</code> is the host and port of the registry</li>
<li><code>wordpress</code> is the name of the image</li>
</ul>
<p>Other examples:</p>
<pre><code>quay.io/coreos/etcd
gcr.io/google-containers/hugo</code></pre>
</div>
</div>
</div>
</section>
<section id="docker-images-15" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Image storage</strong></p>
</div>
<div class="callout-content">
<p>Images can be stored:</p>
<ul>
<li>On your Docker host.</li>
<li>In a Docker registry.</li>
</ul>
<p>You can use the Docker client to download (pull) or upload (push) images.</p>
<!-- To be more accurate: you can use the Docker client to tell a Docker Engine to push and pull images to and from a registry. -->
</div>
</div>
</div>
</section>
<section id="docker-images-16" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Current images</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker images
REPOSITORY                                     TAG            IMAGE ID       CREATED         SIZE
ubuntu                                         latest         353675e2a41b   11 days ago     139MB
mongo                                          latest         a6bda40d00e5   8 weeks ago     1.19GB
mysql                                          8.0            18dee92bbc23   2 months ago    1.06GB
bitnami/redis                                  latest         5927ff3702df   2 months ago    253MB
postgres                                       14             563a4985838f   3 months ago    623MB
node                                           18.20.5        8b7f2b36c945   10 months ago   1.56GB
busybox                                        latest         d82f458899c9   11 months ago   6.21MB
mysql                                          8.0.35         c6812f0dcd97   21 months ago   809MB
postgres                                       11-alpine      ea50b9fd617b   21 months ago   337MB
node                                           16             f77a1aef2da8   2 years ago     1.27GB
maven                                          3-openjdk-11   805f366910ae   3 years ago     1.03GB
jpetazzo/clock                                 latest         dc06bbc3744f   4 years ago     2.32MB</code></pre>
</div>
</div>
</div>
</section>
<section id="docker-images-17" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Image search</strong></p>
</div>
<div class="callout-content">
<p>We cannot list all images on a remote registry, but we can search for a specific keyword:</p>
<pre><code>$ docker search jupyter
NAME                               DESCRIPTION                                     STARS     OFFICIAL
islasgeci/jupyter                  Jupyter para Ciencia de Datos • GECI            0
opendatacube/jupyter               An image with OpenDataCube and Jupyter          1
datajoint/jupyter                  **Deprecated**: Official DataJoint Jupyter n…   0
jupyter/scipy-notebook             Scientific Jupyter Notebook Python Stack fro…   467
jupyter/all-spark-notebook         Python, Scala, R and Spark Jupyter Notebook …   439
jupyter/pyspark-notebook           Python and Spark Jupyter Notebook Stack from…   316
jupyter/tensorflow-notebook        Scientific Jupyter Notebook Python Stack w/ …   372
biocontainers/jupyter                                                              0
jupyter/datascience-notebook       Data Science Jupyter Notebook Python Stack f…   1092
jupyter/minimal-notebook           Minimal Jupyter Notebook Python Stack from h…   199
jupyter/base-notebook              Base image for Jupyter Notebook stacks from …   237
jupyter/nbviewer                   Jupyter Notebook Viewer                         34
jupyter/r-notebook                 R Jupyter Notebook Stack from https://github…   62
jupyter/repo2docker                Turn git repositories into Jupyter enabled D…   22
jupyter/docker-stacks-foundation   Tiny base image on which Jupyter apps can be…   6
jupyter/demo                       (DEPRECATED) Demo of the IPython/Jupyter Not…   16
jupyter/julia-notebook             Julia Jupyter Notebook Stack from https://gi…   4
</code></pre>
<ul>
<li><strong>Stars</strong> indicate the popularity of the image.</li>
<li><strong>Official</strong> images are those in the root namespace. <!-- - **Automated** images are built automatically by the Docker Hub. --> <!-- (This means that their build recipe is always available.) --></li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-18" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Downloading images</strong></p>
</div>
<div class="callout-content">
<p>There are two ways to download images.</p>
<ol type="1">
<li>Explicitly, with <code>docker pull</code>.</li>
<li>Implicitly, when executing <code>docker run</code> and the image is not found locally.</li>
</ol>
</div>
</div>
</div>
</section>
<section id="docker-images-19" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Pulling an image</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker pull debian:jessie
jessie: Pulling from library/debian
f24aff4096a5: Pull complete
Digest: sha256:32ad5050caffb2c7e969dac873bce2c370015c2256ff984b70c1c08b3a2816a0
Status: Downloaded newer image for debian:jessie
docker.io/library/debian:jessie</code></pre>
<ul>
<li>As seen previously, images are made up of layers.</li>
<li>Docker has downloaded all the necessary layers.</li>
<li>In this example, <code>:jessie</code> indicates which exact version of Debian we would like.</li>
</ul>
<p>It is a <strong>version tag</strong>.</p>
</div>
</div>
</div>
</section>
<section id="docker-images-20" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Image tags</strong></p>
</div>
<div class="callout-content">
<p>Images can have tags.</p>
<ul>
<li>Tags define image versions or variants.</li>
<li><code>docker pull ubuntu</code> will refer to ubuntu:latest.</li>
<li>The <code>:latest</code> tag is generally updated often.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-21" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Don’t specify tags:</strong></p>
</div>
<div class="callout-content">
<ul>
<li>When doing rapid testing and prototyping.</li>
<li>When experimenting.</li>
<li>When you want the latest version.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Do specify tags:</strong></p>
</div>
<div class="callout-content">
<ul>
<li>When recording a procedure into a script.</li>
<li>When going to production.</li>
<li>To ensure that the same version will be used everywhere.</li>
<li>To ensure repeatability later.</li>
<li>This is similar to what we would do with <code>pip install</code>, <code>npm install</code>, etc.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-22" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Multi-arch images</strong></p>
</div>
<div class="callout-content">
<p>An image can support multiple architectures</p>
<p>More precisely, a specific tag in a given repository can have either:</p>
<ul>
<li>a single manifest referencing an image for a single architecture</li>
<li>a manifest list (or fat manifest) referencing multiple images</li>
</ul>
<p>In a manifest list, each image is identified by a combination of:</p>
<ul>
<li>os (linux, windows)</li>
<li>architecture (amd64, arm, arm64…)</li>
<li>optional fields like variant (for arm and arm64), os.version (for windows)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="docker-images-23" class="slide level2">
<h2>Docker Images</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Working with multi-arch images</strong></p>
</div>
<div class="callout-content">
<ul>
<li><p>The Docker Engine will pull “native” images when available (images matching its own os/architecture/variant)</p></li>
<li><p>We can ask for a specific image platform with <code>--platform</code></p></li>
<li><p>The Docker Engine can run non-native images thanks to QEMU+binfmt (automatically on Docker Desktop; with a bit of setup on Linux)</p></li>
</ul>
</div>
</div>
</div>
</section></section>
<section>
<section id="building-images-interactively" class="title-slide slide level1 center">
<h1>Building images interactively</h1>

</section>
<section id="building-images-interactively-1" class="slide level2">
<h2>Building images interactively</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>What we will do</strong></p>
</div>
<div class="callout-content">
<p>We will create our first container image. It will be a basic distribution image, but we will pre-install the package figlet.</p>
<p>We will:</p>
<ul>
<li>Create a container from a base image.</li>
<li>Install software manually in the container, and turn it into a new image.</li>
<li>Learn about new commands:
<ul>
<li>docker commit</li>
<li>docker tag</li>
<li>and docker diff.</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="building-images-interactively-2" class="slide level2">
<h2>Building images interactively</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Plan</strong></p>
</div>
<div class="callout-content">
<ol type="1">
<li>Create a container (with <code>docker run</code>) using our base distro of choice.</li>
<li>Run a bunch of commands to install and set up our software in the container.</li>
<li><span style="color:blue;">(Optionally)</span> review changes in the container with <code>docker diff</code>.</li>
<li>Turn the container into a new image with <code>docker commit</code>.</li>
<li><span style="color:blue;">(Optionally)</span> add tags to the image with <code>docker tag</code>.</li>
</ol>
</div>
</div>
</div>
</section>
<section id="building-images-interactively-3" class="slide level2">
<h2>Building images interactively</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Setting up container</strong></p>
</div>
<div class="callout-content">
<ol type="1">
<li>Start an Ubuntu container:</li>
</ol>
<pre><code>$ docker run -it ubuntu
root@65d17729ff6e:/#
</code></pre>
<ol start="2" type="1">
<li>Run the commands:</li>
</ol>
<ul>
<li><code>apt-get update</code> to refresh the list of packages available to install.</li>
<li><code>apt-get install figlet</code> to install the program we are interested in.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="building-images-interactively-4" class="slide level2">
<h2>Building images interactively</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Setting up container</strong></p>
</div>
<div class="callout-content">
<pre><code>root@65d17729ff6e:/# apt-get update
Get:1 http://ports.ubuntu.com/ubuntu-ports noble InRelease [256 kB]
...
Get:18 http://ports.ubuntu.com/ubuntu-ports noble-security/restricted arm64 Packages [3119 kB]
Fetched 34.7 MB in 2s (14.7 MB/s)
Reading package lists... Done
root@65d17729ff6e:/# apt-get install figlet
...
After this operation, 745 kB of additional disk space will be used.
Get:1 http://ports.ubuntu.com/ubuntu-ports noble/universe arm64 figlet arm64 2.2.5-3 [130 kB]
Unpacking figlet (2.2.5-3) ...
Setting up figlet (2.2.5-3) ...
...
root@65d17729ff6e:/# exit
</code></pre>
</div>
</div>
</div>
</section>
<section id="building-images-interactively-5" class="slide level2">
<h2>Building images interactively</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Check changes</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Type <code>exit</code> at the container prompt to leave the interactive session.</li>
<li>Now let’s run <code>docker diff</code> to see the difference between the base image and our container</li>
</ul>
<pre><code>docker diff 65d1
C /usr
C /usr/bin
A /usr/bin/chkfont
A /usr/bin/figlist
A /usr/bin/figlet-figlet
A /usr/bin/figlet
A /usr/bin/showfigfonts
C /usr/share
C /usr/share/doc
A /usr/share/doc/figlet
A /usr/share/doc/figlet/examples
A /usr/share/doc/figlet/changelog.Debian.gz
A /usr/share/doc/figlet/copyright
A /usr/share/emacs
A /usr/share/emacs/site-lisp
A /usr/share/emacs/site-lisp/figlet
...</code></pre>
</div>
</div>
</div>
</section>
<section id="building-images-interactively-6" class="slide level2">
<h2>Building images interactively</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Docker tracks filesystem changes</strong></p>
</div>
<div class="callout-content">
<ul>
<li>An image is read-only.</li>
<li>When we make changes, they happen in a copy of the image.</li>
<li>Docker can show the difference between the image, and its copy.</li>
<li>For performance, Docker uses copy-on-write systems. (i.e.&nbsp;starting a container based on a big image doesn’t incur a huge copy.)</li>
<li>Containers can also be started in read-only mode (their root filesystem will be read-only, but they can still have read-write data volumes)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="building-images-interactively-7" class="slide level2">
<h2>Building images interactively</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Committing changes</strong></p>
</div>
<div class="callout-content">
<p>The <code>docker commit</code> command will:</p>
<ol type="1">
<li>Create a new layer with those changes</li>
<li>And a new image using this new layer.</li>
</ol>
<pre><code>$ docker commit 65d1
sha256:289e61ad4776d701b9133249e91c481f6597b4a178f050d1bcc5df171a2a5bec</code></pre>
<p>The output of the docker commit command will be the ID for your newly created image. We can use it as an argument to <code>docker run</code>.</p>
</div>
</div>
</div>
</section>
<section id="building-images-interactively-8" class="slide level2">
<h2>Building images interactively</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Testing new image</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker run -it 289e6
root@e88f50c79e4c:/# figlet whazzzuuuppp
          _
__      _| |__   __ _ _____________   _ _   _ _   _ _ __  _ __  _ __
\ \ /\ / / '_ \ / _` |_  /_  /_  / | | | | | | | | | '_ \| '_ \| '_ \
 \ V  V /| | | | (_| |/ / / / / /| |_| | |_| | |_| | |_) | |_) | |_) |
  \_/\_/ |_| |_|\__,_/___/___/___|\__,_|\__,_|\__,_| .__/| .__/| .__/
                                                   |_|   |_|   |_|
root@e88f50c79e4c:/#</code></pre>
</div>
</div>
</div>
</section>
<section id="building-images-interactively-9" class="slide level2">
<h2>Building images interactively</h2>
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Tagging images</strong></p>
</div>
<div class="callout-content">
<p>Referring to an image by its ID is not convenient. Let’s tag it instead.</p>
<p>We can use the tag command:</p>
<pre><code>$ docker tag 289e6 figlet</code></pre>
<p>But we can also specify the tag as an extra argument to commit:</p>
<pre><code>$ docker commit 65d1 figlet
sha256:b2e5078491301fbba4fdb585e2e7a826998e438dd698d1c96547df72ce22f470</code></pre>
<p>And then run it using its tag:</p>
<pre><code>$ docker run -it figlet</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="dockerfile" class="title-slide slide level1 center">
<h1>Dockerfile</h1>

</section>
<section id="dockerfile-1" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>What is it?</strong></p>
</div>
<div class="callout-content">
<p>An <strong>automated</strong> way to construct images, as opposed to <strong>manually</strong> executing commands in a shell.</p>
<ul>
<li>A Dockerfile is a build recipe for a Docker image.</li>
<li>It contains a series of instructions telling Docker how an image is constructed.</li>
<li>The docker build command builds an image from a Dockerfile.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="dockerfile-2" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Creating a Dockerfile</strong></p>
</div>
<div class="callout-content">
<p>Our Dockerfile must be in a new, empty directory.</p>
<p>Create a directory to hold our Dockerfile.</p>
<pre><code>$ mkdir myimage</code></pre>
<p>Create a Dockerfile inside this directory.</p>
<pre><code>$ cd myimage
$ nvim Dockerfile</code></pre>
<p>You can use whatever editor you like.</p>
</div>
</div>
</div>
</section>
<section id="dockerfile-3" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Contents</strong></p>
</div>
<div class="callout-content">
<pre><code>FROM ubuntu
RUN apt-get update
RUN apt-get install figlet</code></pre>
<ul>
<li><span style="color:blue;">FROM</span> indicates the base image for our build.</li>
<li>Each <span style="color:blue;">RUN</span> line will be executed by Docker during the build.</li>
<li>Our <span style="color:blue;">RUN</span> commands must be non-interactive. (No input can be provided to Docker during the build.)</li>
</ul>
<p>In many cases, we will add the <code>-y</code> flag to <code>apt-get</code>.</p>
</div>
</div>
</div>
</section>
<section id="dockerfile-4" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Building</strong></p>
</div>
<div class="callout-content">
<p>Save our file, then execute:</p>
<pre><code>$ docker build -t figlet .</code></pre>
<ul>
<li><code>-t</code> indicates the tag to apply to the image.</li>
<li><code>.</code> indicates the location of the build context. We will talk more about the build context later. To keep things simple for now: this is the directory where our <code>Dockerfile</code> is located.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="dockerfile-5" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Full log</strong></p>
</div>
<div class="callout-content">
<pre><code>[+] Building 9.3s (8/8) FINISHED                                                                                                                                                                docker:desktop-linux
 =&gt; [internal] load build definition from Dockerfile                                                                                                                                                            0.0s
 =&gt; =&gt; transferring dockerfile: 95B                                                                                                                                                                             0.0s
 =&gt; [internal] load metadata for docker.io/library/ubuntu:latest                                                                                                                                                0.1s
 =&gt; [internal] load .dockerignore                                                                                                                                                                               0.0s
 =&gt; =&gt; transferring context: 2B                                                                                                                                                                                 0.0s
 =&gt; [1/3] FROM docker.io/library/ubuntu:latest@sha256:353675e2a41babd526e2b837d7ec780c2a05bca0164f7ea5dbbd433d21d166fc                                                                                          3.5s
 =&gt; =&gt; resolve docker.io/library/ubuntu:latest@sha256:353675e2a41babd526e2b837d7ec780c2a05bca0164f7ea5dbbd433d21d166fc                                                                                          3.4s
 =&gt; [auth] library/ubuntu:pull token for registry-1.docker.io                                                                                                                                                   0.0s
 =&gt; [2/3] RUN apt-get update                                                                                                                                                                                    2.9s
 =&gt; [3/3] RUN apt-get install figlet                                                                                                                                                                            1.3s
 =&gt; exporting to image                                                                                                                                                                                          1.6s
 =&gt; =&gt; exporting layers                                                                                                                                                                                         1.3s
 =&gt; =&gt; exporting manifest sha256:0d82650ef2fb2b1107ee3332b4e9167a3da20e4368b8a74764827a3091819ec9                                                                                                               0.0s
 =&gt; =&gt; exporting config sha256:474cb85cf40523c5ac0e1d337e8d97e2d3f9a3e24407a8680fd033d1820e9644                                                                                                                 0.0s
 =&gt; =&gt; exporting attestation manifest sha256:8c2c8be4e7e3253c54cdc1b68d50dd79dad45c73625a3517c7e79ec4ae2220ea                                                                                                   0.0s
 =&gt; =&gt; exporting manifest list sha256:6447daabcad8e301a8e7920b201c41f4ffc9889445c10d06050c085fd73ab8ea                                                                                                          0.0s
 =&gt; =&gt; naming to docker.io/library/figlet:latest                                                                                                                                                                0.0s
 =&gt; =&gt; unpacking to docker.io/library/figlet:latest</code></pre>
</div>
</div>
</div>
</section>
<section id="dockerfile-6" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Steps</strong></p>
</div>
<div class="callout-content">
<ul>
<li><p>BuildKit transfers the Dockerfile and the build context (these are the first two [internal] stages)</p></li>
<li><p>Then it executes the steps defined in the Dockerfile ([1/3], [2/3], [3/3])</p></li>
<li><p>Finally, it exports the result of the build (image definition + collection of layers)</p></li>
</ul>
</div>
</div>
</div>

<aside><div>
<p>In as CI, the output will be different. Revert to old output with <code>--progress=plain</code>.</p>
</div></aside></section>
<section id="dockerfile-7" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Caching system</strong></p>
</div>
<div class="callout-content">
<ul>
<li>After each build step, Docker takes a snapshot of the resulting image.</li>
<li>Before executing a step, Docker checks if it has already built the same sequence.</li>
<li>Docker uses the exact strings defined in your Dockerfile, so:
<ul>
<li><code>RUN apt-get install figlet cowsay</code></li>
<li>is different from</li>
<li><code>RUN apt-get install cowsay figlet</code></li>
</ul></li>
</ul>
<p><code>RUN apt-get update</code> is not re-executed when the mirrors are updated</p>
<p>You can force a rebuild with <code>docker build --no-cache ....</code></p>
</div>
</div>
</div>
</section>
<section id="dockerfile-8" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Result</strong></p>
</div>
<div class="callout-content">
<p>Identical to manual:</p>
<pre><code>docker run -it figlet
root@25ac5862b142:/# figlet hey
 _
| |__   ___ _   _
| '_ \ / _ \ | | |
| | | |  __/ |_| |
|_| |_|\___|\__, |
            |___/
root@25ac5862b142:/#</code></pre>
</div>
</div>
</div>
</section>
<section id="dockerfile-9" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Image history</strong></p>
</div>
<div class="callout-content">
<ul>
<li>The history command lists all the layers composing an image.</li>
<li>For each layer, it shows its creation time, size, and creation command.</li>
<li>When an image was built with a Dockerfile, each layer corresponds to a line of the Dockerfile.</li>
</ul>
<pre><code>docker history figlet
IMAGE          CREATED        CREATED BY                                      SIZE      COMMENT
6447daabcad8   19 hours ago   RUN /bin/sh -c apt-get install figlet # buil…   1.34MB    buildkit.dockerfile.v0
&lt;missing&gt;      19 hours ago   RUN /bin/sh -c apt-get update # buildkit        56.4MB    buildkit.dockerfile.v0
&lt;missing&gt;      12 days ago    /bin/sh -c #(nop)  CMD ["/bin/bash"]            0B
&lt;missing&gt;      12 days ago    /bin/sh -c #(nop) ADD file:4e55519deacaaab35…   110MB
&lt;missing&gt;      12 days ago    /bin/sh -c #(nop)  LABEL org.opencontainers.…   0B
&lt;missing&gt;      12 days ago    /bin/sh -c #(nop)  LABEL org.opencontainers.…   0B
&lt;missing&gt;      12 days ago    /bin/sh -c #(nop)  ARG LAUNCHPAD_BUILD_ARCH     0B
&lt;missing&gt;      12 days ago    /bin/sh -c #(nop)  ARG RELEASE                  0B</code></pre>
</div>
</div>
</div>
</section>
<section id="dockerfile-10" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Why sh -c?</strong></p>
</div>
<div class="callout-content">
<ul>
<li>On UNIX, to start a new program, we need two system calls:
<ul>
<li>fork(), to create a new child process;</li>
<li>execve(), to replace the new child process with the program to run.</li>
</ul></li>
<li>Conceptually, execve() works like this:
<ul>
<li><code>execve(program, [list, of, arguments])</code></li>
</ul></li>
<li>When we run a command, e.g.&nbsp;<code>ls -l /tmp</code>, something needs to parse the command. (i.e.&nbsp;split the program and its arguments into a list.)</li>
<li>The shell is usually doing that. (It also takes care of expanding environment variables and special things like <code>~</code>.)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="dockerfile-11" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Exec syntax</strong></p>
</div>
<div class="callout-content">
<p>Docker can parse the command by itself.</p>
<p>Instead of plain string, or <strong>shell syntax</strong>:</p>
<pre><code>RUN apt-get install figlet</code></pre>
<p>we can use JSON list, or <strong>exec syntax</strong>:</p>
<pre><code>RUN ["apt-get", "install", "figlet"]</code></pre>
</div>
</div>
</div>
</section>
<section id="dockerfile-12" class="slide level2">
<h2>Dockerfile</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Check exec syntax</strong></p>
</div>
<div class="callout-content">
<ol type="1">
<li>Change Dockerfile to</li>
</ol>
<pre><code>FROM ubuntu
RUN apt-get update
RUN ["apt-get", "install", "figlet"]</code></pre>
<ol start="2" type="1">
<li>Build it:</li>
</ol>
<pre><code>docker build -t figlet .</code></pre>
<ol start="3" type="1">
<li>Check history:</li>
</ol>
<pre><code>$ docker history figlet
IMAGE          CREATED         CREATED BY                                      SIZE      COMMENT
18c1be63d556   4 seconds ago   RUN apt-get install figlet # buildkit           1.34MB    buildkit.dockerfile.v0
&lt;missing&gt;      19 hours ago    RUN /bin/sh -c apt-get update # buildkit        56.4MB    buildkit.dockerfile.v0
...</code></pre>
<p>Exact command!</p>
</div>
</div>
</div>
</section></section>
<section>
<section id="cmd-and-entrypoint" class="title-slide slide level1 center">
<h1>CMD and ENTRYPOINT</h1>

</section>
<section id="cmd-and-entrypoint-1" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Default commands</strong></p>
</div>
<div class="callout-content">
<p>When people run our container, we want to greet them with a nice hello message, and using a custom font.</p>
<p>For that, we will execute:</p>
<pre><code>figlet -f script hello</code></pre>
<p><code>-f script</code> tells figlet to use a fancy font.</p>
<p><code>hello</code> is the message that we want it to display.</p>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-2" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Adding CMD to Dockerfile</strong></p>
</div>
<div class="callout-content">
<p>Our new Dockerfile will look like this:</p>
<pre><code>FROM ubuntu
RUN apt-get update
RUN ["apt-get", "install", "figlet"]
CMD figlet -f script hello
CMD defines a default command to run when none is given.</code></pre>
<p>It can appear at any point in the file.</p>
<p>Each CMD will replace and override the previous one. As a result, while you can have multiple CMD lines, it is useless.</p>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-3" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Build and run</strong></p>
</div>
<div class="callout-content">
<pre><code>$ docker build -t figlet .
[+] Building 3.4s (8/8) FINISHED                                                                                                                                                                docker:desktop-linux
...
$ docker run -it figlet
 _          _   _
| |        | | | |
| |     _  | | | |  __
|/ \   |/  |/  |/  /  \_
|   |_/|__/|__/|__/\__/
</code></pre>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-4" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>CMD override</strong></p>
</div>
<div class="callout-content">
<p>If we want to get a shell into our container (instead of running figlet), we just have to specify a different program to run:</p>
<pre><code>$ docker run -it figlet bash
root@3e95f6bafdd9:/#</code></pre>
<p>We specified bash.</p>
<p>It replaced the value of CMD.</p>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-5" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Using ENTRYPOINT</strong></p>
</div>
<div class="callout-content">
<p><strong>Objective:</strong> we want to be able to specify a different message on the command line, while retaining figlet and some default parameters.</p>
<p>In other words, we would like to be able to do this:</p>
<pre><code>$ docker run figlet salut
           _            
          | |           
 ,   __,  | |       _|_ 
/ \_/  |  |/  |   |  |  
 \/ \_/|_/|__/ \_/|_/|_/</code></pre>
<p>We will use the ENTRYPOINT verb in Dockerfile.</p>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-6" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Dockerfile with ENTRYPOINT</strong></p>
</div>
<div class="callout-content">
<p>Our new Dockerfile will look like this:</p>
<pre><code>FROM ubuntu
RUN apt-get update
RUN ["apt-get", "install", "figlet"]
ENTRYPOINT ["figlet", "-f", "script"]</code></pre>
<ul>
<li>ENTRYPOINT defines a base command (and its parameters) for the container.</li>
<li>The command line arguments are appended to those parameters.</li>
<li>Like CMD, ENTRYPOINT can appear anywhere, and replaces the previous value.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-7" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Build</strong></p>
</div>
<div class="callout-content">
<pre><code>docker build -t figlet .
[+] Building 0.1s (7/7) FINISHED                                                                                                                                                                docker:desktop-linux
...
$ docker run figlet salve
           _
          | |
 ,   __,  | |       _
/ \_/  |  |/  |  |_|/
 \/ \_/|_/|__/ \/  |__/

</code></pre>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-8" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Using CMD and ENTRYPOING together</strong></p>
</div>
<div class="callout-content">
<p>If we use ENTRYPOINT and CMD together:</p>
<ul>
<li>ENTRYPOINT will define the base command for our container.</li>
<li>CMD will define the default parameter(s) for this command.</li>
<li>They both have to use JSON syntax.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-9" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Dockerfile</strong></p>
</div>
<div class="callout-content">
<pre><code>FROM ubuntu
RUN apt-get update
RUN ["apt-get", "install", "figlet"]
ENTRYPOINT ["figlet", "-f", "script"]
CMD ["hello world"]</code></pre>
<ul>
<li><code>ENTRYPOINT</code> defines a base command (and its parameters) for the container.</li>
<li>If we don’t specify extra command-line arguments when starting the container, the value of <code>CMD</code> is appended.</li>
<li>Otherwise, our extra command-line arguments are used instead of <code>CMD.</code></li>
</ul>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-10" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Build and run</strong></p>
</div>
<div class="callout-content">
<ol type="1">
<li>Build:</li>
</ol>
<pre><code>$ docker build -t myfiglet .
[+] Building 0.1s (7/7) FINISHED
...</code></pre>
<ol start="2" type="1">
<li>Run without parameters:</li>
</ol>
<pre><code>$ docker run myfiglet
 _          _   _                             _
| |        | | | |                           | |    |
| |     _  | | | |  __             __   ,_   | |  __|
|/ \   |/  |/  |/  /  \_  |  |  |_/  \_/  |  |/  /  |
|   |_/|__/|__/|__/\__/    \/ \/  \__/    |_/|__/\_/|_/


</code></pre>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-11" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Build and run</strong></p>
</div>
<div class="callout-content">
<ol start="3" type="1">
<li>Run with parameters:</li>
</ol>
<pre><code>$ docker run myfiglet hey
 _
| |
| |     _
|/ \   |/  |   |
|   |_/|__/ \_/|/
              /|
              \|
</code></pre>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-12" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>ENTRYPOINT override</strong></p>
</div>
<div class="callout-content">
<p>What if we want to run a shell in our container?</p>
<p>We cannot just do <code>docker run myfiglet bash</code> because that would just tell figlet to display the word “bash.”</p>
<p>We use the <code>--entrypoint</code> parameter:</p>
<pre><code>$ docker run -it --entrypoint bash myfiglet
root@0e2f53d52f7d:/#
</code></pre>
</div>
</div>
</div>
</section>
<section id="cmd-and-entrypoint-13" class="slide level2">
<h2>CMD and ENTRYPOINT</h2>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>CMD and ENTRYPOINT recap</strong></p>
</div>
<div class="callout-content">
<ul>
<li><code>docker run myimage</code> executes <code>ENTRYPOINT</code> + <code>CMD</code></li>
<li><code>docker run myimage args</code> executes <code>ENTRYPOINT</code> + <code>args</code> (overriding <code>CMD</code>)</li>
<li><code>docker run --entrypoint prog myimage</code> executes <code>prog</code> (overriding both)</li>
</ul>
</div>
</div>
</div>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="site_libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"url":"https://mplex.vitv.ly","secret":null,"id":"3a9cb0ec03e3c47cbf0f2cbcf9d330b0bdf4544a56c6a0dd3625969b8a9b70fa"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/dslnu\.github\.io\/data_analytics\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>